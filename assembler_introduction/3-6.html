<!doctype html>
<html>
<head>
<title>2003lk入門 ― 3-6. 価値最大化のための取捨選択（実装）</title>
<meta charset="UTF-8">
<link rel="stylesheet" href="../common.css">
<link rel="stylesheet" href="ny_jurli.css">
<script src="ny_jurli.js"></script>
</head>
<body class="cool">
<h1>2003lk入門</h1>
<a href="index.html">トップに戻る</a>
<div class="ny_jurli">
	<p>→<input type="button" value="非真理設定を隠す" onclick="hide_ny_jurli()">をクリックすると非真理設定が非表示になります。ページを再読み込みすると戻ります。</p>
</div>
<hr>
<h2>ksi.3 実践</h2>
<h3>lexn.6 価値最大化のための取捨選択（実装）</h3>

<p>予め断っておきますが、今回はかなり長くなります。</p>

<hr>

<p>まず、与えられた情報を加工したり、作業用の領域を確保することから始めましょう。</p>

<p>最初に与えられた情報はこうですが、</p>

<div class="machine_state_box">
<table class="memory">
<tr>
	<td class="free_mem">自由</td>
	<td class="free_mem">自由</td>
	<td class="occupied_mem">戻る場所</td>
	<td class="occupied_mem">積載制限</td>
	<td class="occupied_mem">価値一覧</td>
	<td class="occupied_mem">質量一覧</td>
	<td class="occupied_mem">品物の個数</td>
</tr>
<tr>
	<td ></td>
	<td ></td>
	<td>f5@</td>
	<td>f5+4@</td>
	<td>f5+8@</td>
	<td>f5+12@</td>
	<td>f5+16@</td>
</tr>

</table>
</div>

<p>f5より小さい番地に、前回言及した作業用の一覧表（0から積載制限まであれば十分なので、長さは積載制限+1）を2つ確保し、さらに[メモ](firjal)の不足を補うために作業領域をさらに3つ確保します。</p>

<p>最終的に、[住所箱](setistafar)を次のように使っていくことを目標とします。また、一覧表1を0で埋める作業もこの段階でやっておきましょう。</p>

<div class="machine_state_box">
<table class="memory">
<tr>
	<td class="free_mem">一覧表2</td>
	<td class="free_mem">…</td>
	<td class="free_mem">一覧表2</td>
	<td class="free_mem">一覧表1</td>
	<td class="free_mem">…</td>
	<td class="free_mem">一覧表1</td>
	<td class="occupied_mem">領域3</td>
	<td class="occupied_mem">領域2</td>
	<td class="occupied_mem">領域1</td>
	<td class="occupied_mem">戻る場所</td>
	<td class="occupied_mem">積載制限</td>
	<td class="occupied_mem">価値一覧</td>
	<td class="occupied_mem">質量一覧</td>
	<td class="occupied_mem">品物の個数</td>
</tr>
<tr>
	<td></td>
	<td></td>
	<td></td>
	<td></td>
	<td></td>
	<td></td>
	<td>f5@</td>
	<td>f5+4@</td>
	<td>f5+8@</td>
	<td>f5+12@</td>
	<td>f5+16@</td>
	<td>f5+20@</td>
	<td>f5+24@</td>
	<td>f5+28@</td>
</tr>

</table>
</div>

<p>まず、積載制限+1を<code>f0</code>に入れ、それの4倍を<code>f3</code>に入れます。</p>

<div class="box">
<pre>
<strong>nll plelajnefes
kRz f5+4@ f0
ata 1 f0
kRz f0 f3
dRo 2 f3</strong>
…
</pre>
</div>

<p>次に、3つの作業領域を確保するために<code>f5</code>を12減らし、領域3には一覧表2の先頭番地を入れ、領域2には一覧表1の先頭番地を入れます。</p>

<div class="box">
<pre>
nll plelajnefes
kRz f5+4@ f0
ata 1 f0
kRz f0 f3
dRo 2 f3
<strong>nta 12 f5
kRz f5 f5+4@
nta f3 f5+4@
kRz f5+4@ f5@
nta f3 f5@</strong>
…
</pre>
</div>

<p>そうしたら、一覧表1を先頭から0で埋めていきます。「積載制限+1」が既に<code>f0</code>に入っているので、これを減らしていけばちょうど一覧表1の全体が0で埋まります。</p>

<div class="box">
<pre>
nll plelajnefes
kRz f5+4@ f0
ata 1 f0
kRz f0 f3
dRo 2 f3
nta 12 f5
kRz f5 f5+4@
nta f3 f5+4@
kRz f5+4@ f5@
nta f3 f5@

<strong>nta f3 f5
nll iumes
kRz 0 f5@
ata 4 f5
nta 1 f0
fi f0 0 niv   malkRz iumes xx</strong>
</pre>
</div>

<hr>

<p>さて、下ごしらえが終わったので、主となる処理を書いていきましょう。</p>

<p>基本的構造は次のようになります。</p>
<p>[内の](<code>ostor</code>)では「q個まで見た表」から「q+1個まで見た表」を作っていきます。nを増やしながら表を埋めていくという方針を前回立てましたが、<code>ostor</code>が始まる直前に<code>f0</code>に0を入れ、マスを埋めながら<code>f0</code>を4ずつ増やしていきます。</p>

<p>[外](<code>tykuv</code>)では、見る品物の個数を1個ずつ増やしていくという方針に合わせて、<code>f5+8@</code>に0を入れ、4ずつ増やしていきます。</p>


<div class="box">
<pre>
…
kRz 0 f5+8@

nll tykuv
kRz 0 f0
	
nll ostor
fi f5+16@ f0 xylo   malkRz tykuvon_stodup xx
…
ata 4 f0
kRz ostor xx

nll tykuvon_stodup
…
fi f5+8@ … clo   malkRz lesback xx
inj f5@ f5+4@ f5@
ata 4 f5+8@
kRz tykuv xx

nll lesback
…
</pre>
</div>

<hr>
<!--<p>まずは、今回書き上げる処理が最終的にどれほどの長さになるのかをを見てみましょう。</p>-->


<p>最終的にこうなります。</p>
<div class="box">
<pre>
nll plelajnefes
nta 1 f5+16@
kRz f5+4@ f0
ata 1 f0
dRo 2 f5+4@
kRz f0 f3
dRo 2 f3
nta 12 f5
kRz f5 f5+4@
nta f3 f5+4@
kRz f5+4@ f5@
nta f3 f5@

nta f3 f5
nll iumes
kRz 0 f5@
ata 4 f5
nta 1 f0
fi f0 0 niv   malkRz iumes xx
	
kRz 0 f5+8@
	
nll tykuv
kRz 0 f0
	
nll ostor
fi f5+16@ f0 xylo   malkRz tykuvon_stodup xx
	kRz f0 f2
	ata f5+4@ f2
	kRz f2@ f2
	kRz f5+8@ f3
	ata f5+24@ f3
	kRz f3@ f3
	kRz f3 f1
	dRo 2 f1
	fi f1 f0 llo   malkRz lasyk xx
	kRz f0 f1
	dRo 2 f3
	nta f3 f1
	kRz f1 f3
	ata f5+4@ f3
	kRz f3@ f3
	kRz f5+8@ f1
	ata f5+20@ f1
	ata f1@ f3
	kRz f0 f1
	ata f5@ f1
	kRz f3 f1@
	fi f1@ f2 xylo   malkRz f2 f1@
	kRz ostoron_stodup xx
	
	nll lasyk
	kRz f0 f3
	ata f5@ f3
	kRz f2 f3@
	
	nll ostoron_stodup
ata 4 f0
kRz ostor xx
	
nll tykuvon_stodup
	kRz f5+28@ f3
	dRo 2 f3
fi f5+8@ f3 clo   malkRz lesback xx
inj f5@ f5+4@ f5@
ata 4 f5+8@
kRz tykuv xx

nll lesback
	kRz f5@ f0
	ata f5+16@ f0
	kRz f0@ f0
	ata 12 f5
	kRz f5@ xx
</pre>
</div>
<!--
<p>3-3. が28命令、3-4. が19命令であることを考えると、今回の67命令というのは非常に長く感じられるかと思います。</p> -->
<hr>
<a href="./3-5.html">前のページへ</a>&nbsp;&nbsp;&nbsp;<!--<a href="./3-7.html">-->次のページへ<!--</a>-->
<br>
<br>
<br>

</body>
</html>